#!/usr/bin/env python3

import sys
import requests
import pyfiglet
import argparse
from termcolor import colored


def banner():
	banner = pyfiglet.figlet_format("Fuzzer.py")
	print(banner)

def arguments():
	parser = argparse.ArgumentParser(usage="./fuzzer.py --url http://localhost:80/login/FUZZ", description="Fuzzer.py")

	parser.add_argument("-u", dest='url', type=str, help="Target url to fuzz.", required=True)
	parser.add_argument("-w", dest='wordlists', type=str, help="Path to the wordlist.", required=True)
	parser.add_argument("-x", dest='extension', type=str, help="File extensions to fuzz.")

	return parser.parse_args()

args = arguments()
url = args.url
wordlists = args.wordlists
extensions = args.extension.split(',')

def fuzzer(url, wordlists, extensions):
	try:
		with open(wordlists, "r") as file:
			for word in file:
				fuzzUrl = url.replace('FUZZ', word)
				r = requests.get(fuzzUrl)
				if r.status_code == 200:
					print(colored(f"Found directory: {fuzzUrl}", "green"))
				else:
					print(colored(f"Not found: {fuzzUrl}", "red"))
	except KeyboardInterrupt:
		print(colored("Program interrupted.", "red"))
		sys.exit()

if __name__ == "__main__":
	banner()
	if len(sys.argv) < 4:
		print(colored("Feed me more arguments.", "red"))
		print("""
	Options:
		-u\t\tTarget url to fuzz..
		-w\t\tPath to the wordlists.
		-x\t\tFile extensions to fuzz.
			""")
	else:
		fuzzer(url, wordlists, extensions)


